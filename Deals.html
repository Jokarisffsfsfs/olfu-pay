<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deals - TransacSure Market</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/png" href="OLFU.jpg">
  <style>
    :root{
      --primary1:#0bab64; --primary2:#3bb78f;
      --card-shadow: 0 2px 8px rgba(0,0,0,0.08);
      --radius:10px;
    }
    *{box-sizing:border-box}
    body{font-family:Arial, sans-serif;margin:0;background:#fafafa;color:#222}

    /* Header / Navbar (TransacSure style) */
    .topbar{background:linear-gradient(135deg,var(--primary1),var(--primary2));color:#fff;padding:10px 18px;display:flex;justify-content:space-between;align-items:center;gap:12px;position:sticky;top:0;z-index:60}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:44px;height:44px;border-radius:6px;object-fit:cover}
    .brand .title{font-weight:800;font-size:20px}
    .nav-links{display:flex;gap:14px;align-items:center}
    .nav-links a{color:rgba(255,255,255,0.95);text-decoration:none;font-weight:600}
    .nav-actions{display:flex;gap:8px;align-items:center}

    /* Search */
    .search-wrap{display:flex;max-width:980px;margin:12px auto;padding:0 12px;gap:8px}
    .search {flex:1;display:flex;background:#fff;border-radius:28px;padding:6px 8px;align-items:center;box-shadow:var(--card-shadow)}
    .search input{flex:1;border:0;padding:10px 12px;border-radius:20px;font-size:15px;outline:none}
    .search button{background:linear-gradient(135deg,var(--primary1),var(--primary2));border:0;color:#fff;padding:10px 14px;border-radius:20px;cursor:pointer;font-weight:700}
    .suggestions{position:relative}
    .suggest-list{position:absolute;left:0;right:0;background:#fff;border-radius:8px;padding:6px;box-shadow:var(--card-shadow);z-index:30;max-height:220px;overflow:auto}

    /* Hero */
    .hero{height:220px;margin:18px auto;max-width:1200px;border-radius:12px;overflow:hidden;position:relative;background:#ddd;display:flex;align-items:center}
    .hero .hero-left{flex:1;padding:28px;color:#fff;font-weight:800}
    .hero .hero-right{flex:1;background-size:cover;background-position:center}

    /* Promo banners */
    .promo-row{display:flex;gap:12px;max-width:1200px;margin:12px auto;padding:0 12px}
    .promo{flex:1;background:#fff;border-radius:10px;padding:12px;display:flex;gap:12px;align-items:center;box-shadow:var(--card-shadow)}
    .promo img{width:100px;height:80px;object-fit:cover;border-radius:8px}

    /* Categories */
    .categories{max-width:1200px;margin:18px auto;padding:0 12px;display:flex;gap:10px;flex-wrap:wrap}
    .category{background:#fff;padding:10px 14px;border-radius:999px;border:1px solid #e6efe9;color:var(--primary1);font-weight:700;cursor:pointer;box-shadow:var(--card-shadow)}
    .category span{display:block;font-size:12px;color:#666;font-weight:600}
    .category.active{box-shadow:0 6px 18px rgba(11,138,88,0.12);transform:translateY(-2px)}

    /* Layout */
    .main {max-width:1200px;margin:18px auto;display:grid;grid-template-columns: 1fr 320px;gap:18px;padding:0 12px}
    @media (max-width:980px){ .main{grid-template-columns:1fr} .promo-row{flex-direction:column} .cart-sidebar{position:fixed;right:0;top:0;bottom:0;width:100%;max-width:420px} }

    /* Product grid */
    .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
    .product{background:#fff;border-radius:12px;padding:12px;box-shadow:var(--card-shadow);display:flex;flex-direction:column;gap:8px;transition:transform .12s}
    .product:hover{transform:translateY(-6px)}
    .product img{width:100%;height:160px;object-fit:cover;border-radius:8px}
    .p-title{font-weight:700;font-size:14px;min-height:44px}
    .p-price{color:var(--primary1);font-weight:800}
    .p-meta{display:flex;justify-content:space-between;align-items:center;font-size:13px;color:#777}
    .badge{background:linear-gradient(135deg,var(--primary1),var(--primary2));color:#fff;padding:4px 8px;border-radius:8px;font-weight:700;font-size:12px}
    .discount-badge{background:#ff4d4f;color:#fff;padding:6px 8px;border-radius:8px;font-weight:800;position:absolute;top:12px;left:12px;font-size:12px}

    .prod-actions{display:flex;gap:8px;margin-top:auto}
    .btn{border:0;padding:8px;border-radius:8px;cursor:pointer;font-weight:700}
    .btn-outline{background:#fff;border:1px solid #ddd}
    .btn-primary{background:linear-gradient(135deg,var(--primary1),var(--primary2));color:#fff}

    /* Sidebar / Cart */
    .cart-sidebar{background:#fff;border-radius:10px;padding:12px;height:fit-content;box-shadow:var(--card-shadow)}
    .cart-item{display:flex;gap:8px;align-items:center;padding:8px;border-bottom:1px dashed #eee}
    .cart-item img{width:56px;height:56px;object-fit:cover;border-radius:6px}
    .cart-footer{display:flex;justify-content:space-between;align-items:center;padding-top:8px}

    /* Floating cart button */
    .cart-float{position:fixed;right:18px;bottom:18px;background:linear-gradient(135deg,var(--primary1),var(--primary2));color:#fff;padding:14px;border-radius:50%;box-shadow:0 6px 20px rgba(0,0,0,0.18);cursor:pointer;z-index:70}
    .cart-count{background:#ff4d4f;color:#fff;padding:4px 7px;border-radius:999px;font-size:12px;margin-left:6px}

    /* Modal quick view */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:90}
    .modal{background:#fff;border-radius:12px;max-width:920px;width:94%;padding:16px;display:flex;gap:12px}
    @media(max-width:720px){.modal{flex-direction:column}}
    .modal img{width:320px;height:320px;object-fit:cover;border-radius:8px}
    .modal .meta{flex:1}

    footer{background:#222;color:#fff;padding:18px;text-align:center;margin-top:28px;border-top:4px solid rgba(255,255,255,0.03)}
  </style>
</head>
<body>

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="brand">
      <img src="OLFU.jpg" alt="OLFU">
      <div>
        <div class="title">TransacSure</div>
        <div style="font-size:12px;opacity:.9">Trusted Marketplace for OLFU Students</div>
      </div>
    </div>

    <div class="nav-links" aria-hidden>
      <a href="TransacSure.html">Home</a>
      <a href="Categories.html">Categories</a>
      <a href="Deals.html">Deals</a>
      <a href="Profile.html">Profile</a>
    </div>

    <div class="nav-actions">
      <div style="font-weight:700" id="greet">Welcome</div>
      <div class="cart-float" id="openCart" title="Open cart">ðŸ›’ <span class="cart-count" id="floatCount">0</span></div>
    </div>
  </div>

  <!-- SEARCH -->
  <div class="search-wrap">
    <div class="search">
      <input id="searchInput" placeholder="Search deals, e.g., backpack, earbuds, physics textbook..." autocomplete="off" />
      <button id="searchBtn">Search</button>
    </div>
    <div class="suggestions">
      <div class="suggest-list" id="suggestList" style="display:none"></div>
    </div>
  </div>

  <!-- HERO -->
  <div class="hero" aria-hidden>
    <div class="hero-left" style="background:linear-gradient(135deg,rgba(0,0,0,0.2),rgba(0,0,0,0.2)), url('https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=1200&q=60');background-size:cover">
      <div style="font-size:28px;color:#fff;font-weight:900">Today's Best Deals</div>
      <div style="margin-top:8px;color:#fff;opacity:.95">Limited-time discounts across uniforms, books, gadgets, food and dorm essentials â€” student-friendly prices</div>
    </div>
    <div class="hero-right" style="background-image:url('https://images.unsplash.com/photo-1523275335684-37898b6baf30?auto=format&fit=crop&w=1200&q=60')"></div>
  </div>

  <!-- PROMOS -->
  <div class="promo-row">
    <div class="promo">
      <img src="https://img.freepik.com/free-vector/super-sale-banner-template_23-2148895248.jpg?w=200" alt="">
      <div>
        <div style="font-weight:800">Flash Sale</div>
        <div style="font-size:13px;color:#666">Up to 70% off selected items</div>
      </div>
    </div>
    <div class="promo">
      <img src="https://img.freepik.com/free-vector/discount-labels-sale-poster_1262-20574.jpg?w=200" alt="">
      <div>
        <div style="font-weight:800">Campus Pickup</div>
        <div style="font-size:13px;color:#666">Fast pickup on campus</div>
      </div>
    </div>
    <div class="promo">
      <img src="https://img.freepik.com/free-vector/cashback-offer-poster-template_23-2148707113.jpg?w=200" alt="">
      <div>
        <div style="font-weight:800">Student Cashback</div>
        <div style="font-size:13px;color:#666">Earn rewards when you buy</div>
      </div>
    </div>
  </div>

  <!-- CATEGORIES -->
  <div class="categories" role="list" id="categoryList"></div>

  <!-- MAIN: deals + cart sidebar -->
  <div class="main">
    <div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <h2 id="sectionTitle" style="margin:0">Hot Deals</h2>
        <div style="color:#666;font-weight:700" id="resultCount">0 items</div>
      </div>

      <div class="products" id="productGrid"></div>
    </div>

    <aside class="cart-sidebar" id="cartSidebar" aria-label="Cart">
      <h3 style="margin:0 0 8px 0">Your Cart</h3>
      <div id="cartItems">
        <div style="color:#666">Cart is empty</div>
      </div>
      <div class="cart-footer" style="margin-top:8px">
        <div style="font-weight:800">Total: â‚±<span id="cartTotal">0</span></div>
        <button class="btn btn-primary" onclick="checkout()">Checkout</button>
      </div>
    </aside>
  </div>

  <!-- QUICK VIEW / MODAL -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-hidden="true">
    <div class="modal" role="document">
      <img id="modalImg" src="" alt="product">
      <div class="meta">
        <h3 id="modalTitle"></h3>
        <div style="color:var(--primary1);font-weight:800;font-size:20px" id="modalPrice"></div>
        <p id="modalDesc" style="color:#555"></p>
        <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
          <input id="modalQty" type="number" min="1" value="1" style="width:80px;padding:8px;border-radius:8px;border:1px solid #ddd">
          <button class="btn btn-primary" id="modalAdd">Add to cart</button>
          <button class="btn btn-outline" onclick="closeModal()">Close</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    &copy; 2025 TransacSure Market. Built for students.
  </footer>

  <script>
    // Expanded product set (added uniforms per level, more books, gadgets, stationery, dorm essentials)
    const PRODUCTS = [
      // Electronics / Gadgets
      {id:1,name:"Wireless Earbuds",price:599,oldPrice:799,discount:25,category:"Electronics",img:"https://images.unsplash.com/photo-1585386959984-a4155223f6ce?auto=format&fit=crop&w=800&q=60",desc:"Compact Bluetooth earbuds with clear sound."},
      {id:2,name:"Smart Watch",price:999,oldPrice:1499,discount:33,category:"Electronics",img:"https://images.unsplash.com/photo-1516574187841-cb9cc2ca948b?auto=format&fit=crop&w=800&q=60",desc:"Fitness tracking and notifications on the go."},
      {id:10,name:"USB Flash Drive 64GB",price:299,oldPrice:399,discount:25,category:"Electronics",img:"https://images.unsplash.com/photo-1587829741301-dc798b83add3?auto=format&fit=crop&w=800&q=60",desc:"Fast file transfer and portable storage."},
      {id:20,name:"Power Bank 10,000mAh",price:499,oldPrice:699,discount:29,category:"Gadgets",img:"https://images.unsplash.com/photo-1517336714731-489689fd1ca8?auto=format&fit=crop&w=800&q=60",desc:"Reliable backup power for long days on campus."},
      {id:21,name:"USB-C Charger 30W",price:349,oldPrice:499,discount:30,category:"Gadgets",img:"https://images.unsplash.com/photo-1580910051072-7f3b9b3b5b1d?auto=format&fit=crop&w=800&q=60",desc:"Fast charging for phones and tablets."},

      // Accessories
      {id:3,name:"School Backpack",price:350,oldPrice:500,discount:30,category:"Accessories",img:"https://images.unsplash.com/photo-1523275335684-37898b6baf30?auto=format&fit=crop&w=800&q=60",desc:"Lightweight backpack with laptop compartment."},
      {id:9,name:"Campus Sneakers",price:1299,oldPrice:1699,discount:24,category:"Accessories",img:"https://images.unsplash.com/photo-1528701800489-4765a6f6f0b0?auto=format&fit=crop&w=800&q=60",desc:"Comfortable sneakers for daily campus use."},

      // Books
      {id:7,name:"Physics 1 Textbook",price:380,oldPrice:480,discount:21,category:"Books",img:"https://images.unsplash.com/photo-1512820790803-83ca734da794?auto=format&fit=crop&w=800&q=60",desc:"Comprehensive physics textbook for beginners."},
      {id:11,name:"Chemistry Lab Manual",price:420,oldPrice:520,discount:19,category:"Books",img:"https://images.unsplash.com/photo-1516979187457-637abb4f9353?auto=format&fit=crop&w=800&q=60",desc:"Lab procedures and safety guidelines."},
      {id:22,name:"Calculus Workbook",price:320,oldPrice:420,discount:24,category:"Books",img:"https://images.unsplash.com/photo-1529070538774-1843cb3265df?auto=format&fit=crop&w=800&q=60",desc:"Practice problems for calculus students."},
      {id:23,name:"Elementary Reading Set",price:250,oldPrice:350,discount:29,category:"Books",img:"https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?auto=format&fit=crop&w=800&q=60",desc:"Colorful readers for elementary learners."},

      // Supplies / Stationery
      {id:4,name:"Notebook Bundle (10 pcs)",price:200,oldPrice:300,discount:33,category:"Supplies",img:"https://images.unsplash.com/photo-1515879218367-8466d910aaa4?auto=format&fit=crop&w=800&q=60",desc:"Sturdy notebooks for all your subjects."},
      {id:8,name:"Stationery Kit",price:129,oldPrice:199,discount:35,category:"Supplies",img:"https://images.unsplash.com/photo-1580910051072-7f3b9b3b5b1d?auto=format&fit=crop&w=800&q=60",desc:"Pens, highlighters, erasers and rulers."},
      {id:24,name:"Scientific Calculator",price:899,oldPrice:1199,discount:25,category:"Gadgets",img:"https://images.unsplash.com/photo-1596496051614-6a3b2ed87a8f?auto=format&fit=crop&w=800&q=60",desc:"Required for lab and math classes."},

      // Food
      {id:5,name:"Lunch Meal - Rice + Ulam",price:99,oldPrice:150,discount:34,category:"Food",img:"https://images.unsplash.com/photo-1604908177522-7f3c90d6d8b3?auto=format&fit=crop&w=800&q=60",desc:"Affordable campus lunch pack."},
      {id:12,name:"Snack Pack (Assorted)",price:89,oldPrice:140,discount:36,category:"Food",img:"https://images.unsplash.com/photo-1604908177523-8a0b3d82b1d7?auto=format&fit=crop&w=800&q=60",desc:"Assorted snacks â€” great for study breaks."},

      // Uniforms - multiple levels
      {id:30,name:"Elementary Uniform Set",price:450,oldPrice:600,discount:25,category:"Uniforms - Elementary",img:"https://images.unsplash.com/photo-1520975912411-ec2a3c693d35?auto=format&fit=crop&w=800&q=60",desc:"Complete elementary school uniform set."},
      {id:31,name:"Highschool Uniform Set",price:850,oldPrice:1100,discount:23,category:"Uniforms - Highschool",img:"https://images.unsplash.com/photo-1520975912411-ec2a3c693d35?auto=format&fit=crop&w=800&q=60",desc:"Highschool uniform with name patch."},
      {id:32,name:"Senior High Uniform Full Set",price:1500,oldPrice:2000,discount:25,category:"Uniforms - Senior High",img:"https://images.unsplash.com/photo-1520975912411-ec2a3c693d35?auto=format&fit=crop&w=800&q=60",desc:"Senior High official uniform."},
      {id:33,name:"College Polo & ID Lanyard",price:680,oldPrice:900,discount:24,category:"Uniforms - College",img:"https://images.unsplash.com/photo-1520975912411-ec2a3c693d35?auto=format&fit=crop&w=800&q=60",desc:"College polo shirt plus lanyard."},

      // Dorm Essentials
      {id:40,name:"Bedside Lamp",price:299,oldPrice:399,discount:25,category:"Dorm",img:"https://images.unsplash.com/photo-1524758631624-e2822e304c36?auto=format&fit=crop&w=800&q=60",desc:"Adjustable lamp for late-night study."},
      {id:41,name:"Mini Fan",price:249,oldPrice:349,discount:29,category:"Dorm",img:"https://images.unsplash.com/photo-1522199710521-72d69614c702?auto=format&fit=crop&w=800&q=60",desc:"USB-powered compact fan."},
      {id:42,name:"Laundry Bag",price:189,oldPrice:249,discount:24,category:"Dorm",img:"https://images.unsplash.com/photo-1581574202995-6b8c4f6b0b2b?auto=format&fit=crop&w=800&q=60",desc:"Portable laundry bag for dorm use."}
    ];

    const CATEGORIES = [
      "All","Electronics","Gadgets","Accessories","Books","Supplies","Food",
      "Uniforms - Elementary","Uniforms - Highschool","Uniforms - Senior High","Uniforms - College","Dorm"
    ];

    // render category buttons
    const categoryList = document.getElementById('categoryList');
    CATEGORIES.forEach(c=>{
      const el = document.createElement('div');
      el.className = 'category';
      el.innerHTML = `${c} <span>${c==='All'?'Everything':c}</span>`;
      el.addEventListener('click', ()=> applyCategory(c));
      categoryList.appendChild(el);
    });

    // product rendering
    const grid = document.getElementById('productGrid');
    const resultCount = document.getElementById('resultCount');
    const sectionTitle = document.getElementById('sectionTitle');

    function renderProducts(list){
      grid.innerHTML = '';
      if(!list.length){
        grid.innerHTML = '<div style="color:#666">No products found</div>';
        resultCount.textContent = '0 items';
        return;
      }
      resultCount.textContent = list.length + (list.length===1 ? ' item' : ' items');
      list.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'product';
        card.style.position = 'relative';
        card.innerHTML = `
          ${p.discount ? `<div class="discount-badge">-${p.discount}%</div>` : ''}
          <img src="${p.img}" alt="${p.name}">
          <div class="p-title">${p.name}</div>
          <div class="p-meta">
            <div class="p-price">â‚±${p.price}</div>
            <div class="badge">${p.category}</div>
          </div>
          <div style="font-size:13px;color:#666;min-height:36px">${p.desc}</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
            <div style="color:#888;font-size:13px">${p.oldPrice?`<span style='text-decoration:line-through;color:#bbb'>â‚±${p.oldPrice}</span>`:''}</div>
            <div class="prod-actions">
              <button class="btn btn-outline" onclick="openQuickView(${p.id})">Quick View</button>
              <button class="btn btn-primary" onclick="addToCartId(${p.id},1)">Add to Cart</button>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // category selection
    function applyCategory(cat){
      sectionTitle.textContent = cat==='All' ? 'Hot Deals' : `${cat}`;
      const list = cat==='All' ? PRODUCTS : PRODUCTS.filter(p=>p.category===cat);
      renderProducts(list);
      document.querySelectorAll('.category').forEach(el=>{
        el.classList.toggle('active', el.textContent.trim().startsWith(cat));
      });
    }

    // init with all deals
    applyCategory('All');

    // search & suggestions
    const searchInput = document.getElementById('searchInput');
    const suggestList = document.getElementById('suggestList');
    searchInput.addEventListener('input', ()=>{
      const q = searchInput.value.trim().toLowerCase();
      if(!q){ suggestList.style.display='none'; return; }
      const matches = PRODUCTS.filter(p=>p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q)).slice(0,8);
      if(!matches.length){ suggestList.style.display='none'; return; }
      suggestList.innerHTML = matches.map(m=>`<div style="padding:8px;border-bottom:1px solid #f1f1f1;cursor:pointer" onclick="selectSuggestion('${m.name.replace(/'/g,"\\'")}')">${m.name} <small style="color:#666">â€¢ ${m.category}</small></div>`).join('');
      suggestList.style.display='block';
    });
    function selectSuggestion(val){ searchInput.value = val; suggestList.style.display='none'; doSearch(); }
    document.addEventListener('click', (e)=>{ if(!e.target.closest('.suggestions') && !e.target.closest('.search')) suggestList.style.display='none'; });
    document.getElementById('searchBtn').addEventListener('click', doSearch);
    searchInput.addEventListener('keydown', e=>{ if(e.key==='Enter') doSearch(); });
    function doSearch(){
      const q = searchInput.value.trim().toLowerCase();
      if(!q){ applyCategory('All'); return; }
      const res = PRODUCTS.filter(p=>p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q));
      sectionTitle.textContent = `Search: "${searchInput.value}"`;
      renderProducts(res);
    }

    // Quick view modal
    const modalBackdrop = document.getElementById('modalBackdrop');
    function openQuickView(id){
      const p = PRODUCTS.find(x=>x.id===id); if(!p) return;
      document.getElementById('modalImg').src = p.img;
      document.getElementById('modalTitle').textContent = p.name;
      document.getElementById('modalPrice').textContent = 'â‚±' + p.price;
      document.getElementById('modalDesc').textContent = p.desc + (p.oldPrice? ` â€” was â‚±${p.oldPrice}` : '');
      document.getElementById('modalQty').value = 1;
      document.getElementById('modalAdd').onclick = ()=>{ addToCartId(p.id, Number(document.getElementById('modalQty').value)); closeModal(); }
      modalBackdrop.style.display = 'flex';
      modalBackdrop.setAttribute('aria-hidden','false');
    }
    function closeModal(){ modalBackdrop.style.display = 'none'; modalBackdrop.setAttribute('aria-hidden','true'); }

    // Cart logic (localStorage)
    let cart = JSON.parse(localStorage.getItem('ts_cart')||'[]');
    const cartItemsEl = document.getElementById('cartItems'), cartTotalEl = document.getElementById('cartTotal'), floatCount = document.getElementById('floatCount');
    function persist(){ localStorage.setItem('ts_cart', JSON.stringify(cart)); updateCartUI(); }
    function updateCartUI(){
      floatCount.textContent = cart.reduce((s,n)=>s+n.qty,0);
      cartTotalEl.textContent = cart.reduce((s,i)=>s + i.qty * i.price, 0);
      if(!cart.length){ cartItemsEl.innerHTML = '<div style="color:#666">Cart is empty</div>'; return; }
      cartItemsEl.innerHTML = cart.map(it=>`
        <div class="cart-item">
          <img src="${it.img}" alt="${it.name}">
          <div style="flex:1">
            <div style="font-weight:700">${it.name}</div>
            <div style="color:#666;font-size:13px">â‚±${it.price} â€¢ Qty: ${it.qty}</div>
            <div style="margin-top:6px"><button class="btn btn-outline" onclick="changeQty(${it.id}, -1)">-</button> <button class="btn btn-outline" onclick="changeQty(${it.id}, 1)">+</button> <button class="btn btn-outline" onclick="removeItem(${it.id})">Remove</button></div>
          </div>
        </div>
      `).join('');
    }
    function addToCartId(id, qty=1){
      const p = PRODUCTS.find(x=>x.id===id); if(!p) return;
      const existing = cart.find(c=>c.id===id);
      if(existing) existing.qty += qty; else cart.push({id:p.id,name:p.name,price:p.price,qty,img:p.img});
      persist(); alert(p.name + ' added to cart');
    }
    function changeQty(id, delta){
      const it = cart.find(c=>c.id===id); if(!it) return;
      it.qty += delta; if(it.qty<=0) cart = cart.filter(c=>c.id!==id);
      persist();
    }
    function removeItem(id){ cart = cart.filter(c=>c.id!==id); persist(); }
    function checkout(){
      if(!cart.length){ alert('Your cart is empty.'); return; }
      alert('Checkout not implemented in this demo. Total: â‚±' + cart.reduce((s,i)=>s+i.qty*i.price,0));
    }

    // UI init
    persist();
    document.getElementById('openCart').addEventListener('click',()=>{ window.scrollTo({top:0,behavior:'smooth'}); document.querySelector('aside').scrollIntoView({behavior:'smooth'}); });

    // expose functions for inline handlers
    window.addToCartId = addToCartId;
    window.openQuickView = openQuickView;
    window.changeQty = changeQty;
    window.removeItem = removeItem;
    window.applyCategory = applyCategory;
    window.checkout = checkout;
  </script>
</body>
</html>
